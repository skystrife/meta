<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>ModErn Text Analysis: meta::classify::sgd&lt; LossFunction &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ModErn Text Analysis
   </div>
   <div id="projectbrief">META Enumerates Textual Applications</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacemeta.html">meta</a></li><li class="navelem"><a class="el" href="namespacemeta_1_1classify.html">classify</a></li><li class="navelem"><a class="el" href="classmeta_1_1classify_1_1sgd.html">sgd</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-types">Private Types</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classmeta_1_1classify_1_1sgd-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">meta::classify::sgd&lt; LossFunction &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Implements stochastic gradient descent for learning binary linear classifiers.  
 <a href="classmeta_1_1classify_1_1sgd.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="sgd_8h_source.html">sgd.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for meta::classify::sgd&lt; LossFunction &gt;:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classmeta_1_1classify_1_1sgd.png" usemap="#meta::classify::sgd&lt; LossFunction &gt;_map" alt=""/>
  <map id="meta::classify::sgd&lt; LossFunction &gt;_map" name="meta::classify::sgd&lt; LossFunction &gt;_map">
<area href="classmeta_1_1classify_1_1classifier.html" alt="meta::classify::classifier&lt; index::forward_index &gt;" shape="rect" coords="0,0,285,24"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a88d43593c612c65a81e8b72828ef8f7d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmeta_1_1classify_1_1sgd.html#a88d43593c612c65a81e8b72828ef8f7d">sgd</a> (<a class="el" href="classmeta_1_1index_1_1forward__index.html">index::forward_index</a> &amp;idx, double alpha=0.001, double gamma=1e-6, double bias=1, double lambda=0.0001, size_t max_iter=50)</td></tr>
<tr class="separator:a88d43593c612c65a81e8b72828ef8f7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61d0e7bcadc6519aafc1f7a7ad374a76"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmeta_1_1classify_1_1sgd.html#a61d0e7bcadc6519aafc1f7a7ad374a76">sgd</a> (<a class="el" href="classmeta_1_1index_1_1forward__index.html">index::forward_index</a> &amp;idx, class_label positive_label, double alpha=0.001, double gamma=1e-6, double bias=1, double lambda=0.0001, size_t max_iter=50)</td></tr>
<tr class="separator:a61d0e7bcadc6519aafc1f7a7ad374a76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72fe830f32d506eff232b7be6a9333b9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmeta_1_1classify_1_1sgd.html#a72fe830f32d506eff232b7be6a9333b9">train</a> (const std::vector&lt; doc_id &gt; &amp;docs) override</td></tr>
<tr class="memdesc:a72fe830f32d506eff232b7be6a9333b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Trains the sgd on the given training documents.  <a href="#a72fe830f32d506eff232b7be6a9333b9">More...</a><br/></td></tr>
<tr class="separator:a72fe830f32d506eff232b7be6a9333b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c80be17fa19e641f3eb788bf59881c4"><td class="memItemLeft" align="right" valign="top">class_label&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmeta_1_1classify_1_1sgd.html#a3c80be17fa19e641f3eb788bf59881c4">classify</a> (doc_id d_id) override</td></tr>
<tr class="memdesc:a3c80be17fa19e641f3eb788bf59881c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Classifies the given document.  <a href="#a3c80be17fa19e641f3eb788bf59881c4">More...</a><br/></td></tr>
<tr class="separator:a3c80be17fa19e641f3eb788bf59881c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6851424c6d215ec60b1bc10db8c1157"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmeta_1_1classify_1_1sgd.html#aa6851424c6d215ec60b1bc10db8c1157">predict</a> (doc_id d_id) const </td></tr>
<tr class="memdesc:aa6851424c6d215ec60b1bc10db8c1157"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the dot product with the current weight vector.  <a href="#aa6851424c6d215ec60b1bc10db8c1157">More...</a><br/></td></tr>
<tr class="separator:aa6851424c6d215ec60b1bc10db8c1157"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c1a33f6810fd8f0f070d32891b671fa"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3c1a33f6810fd8f0f070d32891b671fa"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmeta_1_1classify_1_1sgd.html#a3c1a33f6810fd8f0f070d32891b671fa">reset</a> () override</td></tr>
<tr class="memdesc:a3c1a33f6810fd8f0f070d32891b671fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resets all learned information for this sgd so it may be re-learned. <br/></td></tr>
<tr class="separator:a3c1a33f6810fd8f0f070d32891b671fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classmeta_1_1classify_1_1classifier"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classmeta_1_1classify_1_1classifier')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classmeta_1_1classify_1_1classifier.html">meta::classify::classifier&lt; index::forward_index &gt;</a></td></tr>
<tr class="memitem:a2803af1f7684f86707125dbe055b9136 inherit pub_methods_classmeta_1_1classify_1_1classifier"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmeta_1_1classify_1_1classifier.html#a2803af1f7684f86707125dbe055b9136">classifier</a> (<a class="el" href="classmeta_1_1index_1_1forward__index.html">index::forward_index</a> &amp;idx)</td></tr>
<tr class="separator:a2803af1f7684f86707125dbe055b9136 inherit pub_methods_classmeta_1_1classify_1_1classifier"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6423f5db3346d1aa3060bfb3b5f7486c inherit pub_methods_classmeta_1_1classify_1_1classifier"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classmeta_1_1classify_1_1confusion__matrix.html">confusion_matrix</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmeta_1_1classify_1_1classifier.html#a6423f5db3346d1aa3060bfb3b5f7486c">test</a> (const std::vector&lt; doc_id &gt; &amp;docs)</td></tr>
<tr class="memdesc:a6423f5db3346d1aa3060bfb3b5f7486c inherit pub_methods_classmeta_1_1classify_1_1classifier"><td class="mdescLeft">&#160;</td><td class="mdescRight">Classifies a collection document into specific groups, as determined by training data; this function will make repeated calls to <a class="el" href="classmeta_1_1classify_1_1classifier.html#ade8be2ad9ce2996b38ab185dfb630cfd" title="Classifies a document into a specific group, as determined by training data. ">classify()</a>.  <a href="#a6423f5db3346d1aa3060bfb3b5f7486c">More...</a><br/></td></tr>
<tr class="separator:a6423f5db3346d1aa3060bfb3b5f7486c inherit pub_methods_classmeta_1_1classify_1_1classifier"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ef8fb8e55daa925425bf5971e32e9ba inherit pub_methods_classmeta_1_1classify_1_1classifier"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classmeta_1_1classify_1_1confusion__matrix.html">confusion_matrix</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmeta_1_1classify_1_1classifier.html#a7ef8fb8e55daa925425bf5971e32e9ba">cross_validate</a> (const std::vector&lt; doc_id &gt; &amp;input_docs, size_t k, int seed=1)</td></tr>
<tr class="memdesc:a7ef8fb8e55daa925425bf5971e32e9ba inherit pub_methods_classmeta_1_1classify_1_1classifier"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs k-fold cross-validation on a set of documents.  <a href="#a7ef8fb8e55daa925425bf5971e32e9ba">More...</a><br/></td></tr>
<tr class="separator:a7ef8fb8e55daa925425bf5971e32e9ba inherit pub_methods_classmeta_1_1classify_1_1classifier"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-types"></a>
Private Types</h2></td></tr>
<tr class="memitem:a42214fae688fdb92442abbec4d1d3e60"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a42214fae688fdb92442abbec4d1d3e60"></a>
using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmeta_1_1classify_1_1sgd.html#a42214fae688fdb92442abbec4d1d3e60">counts_t</a> = std::vector&lt; std::pair&lt; term_id, double &gt;&gt;</td></tr>
<tr class="memdesc:a42214fae688fdb92442abbec4d1d3e60"><td class="mdescLeft">&#160;</td><td class="mdescRight">Typedef for the sparse vector training/test instances. <br/></td></tr>
<tr class="separator:a42214fae688fdb92442abbec4d1d3e60"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:aa42f22d7c0df61f0b283b1f25b31d76a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmeta_1_1classify_1_1sgd.html#aa42f22d7c0df61f0b283b1f25b31d76a">predict</a> (const <a class="el" href="classmeta_1_1classify_1_1sgd.html#a42214fae688fdb92442abbec4d1d3e60">counts_t</a> &amp;doc) const </td></tr>
<tr class="memdesc:aa42f22d7c0df61f0b283b1f25b31d76a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function that takes a sparse vector.  <a href="#aa42f22d7c0df61f0b283b1f25b31d76a">More...</a><br/></td></tr>
<tr class="separator:aa42f22d7c0df61f0b283b1f25b31d76a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a0f8144e5e476da618e2cf8cdef3330c8"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0f8144e5e476da618e2cf8cdef3330c8"></a>
class_label&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmeta_1_1classify_1_1sgd.html#a0f8144e5e476da618e2cf8cdef3330c8">positive_label_</a></td></tr>
<tr class="memdesc:a0f8144e5e476da618e2cf8cdef3330c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">The label for positive examples. <br/></td></tr>
<tr class="separator:a0f8144e5e476da618e2cf8cdef3330c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69287a881cca8445866337329e2f1c37"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a69287a881cca8445866337329e2f1c37"></a>
class_label&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmeta_1_1classify_1_1sgd.html#a69287a881cca8445866337329e2f1c37">negative_label_</a></td></tr>
<tr class="memdesc:a69287a881cca8445866337329e2f1c37"><td class="mdescLeft">&#160;</td><td class="mdescRight">The label for negative examples. <br/></td></tr>
<tr class="separator:a69287a881cca8445866337329e2f1c37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad90e1a02cd0bd68b6609f591cbba01b1"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad90e1a02cd0bd68b6609f591cbba01b1"></a>
std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmeta_1_1classify_1_1sgd.html#ad90e1a02cd0bd68b6609f591cbba01b1">weights_</a></td></tr>
<tr class="memdesc:ad90e1a02cd0bd68b6609f591cbba01b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">The weights vector. <br/></td></tr>
<tr class="separator:ad90e1a02cd0bd68b6609f591cbba01b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4f2046211231e4fee7d5f1d651202b2"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab4f2046211231e4fee7d5f1d651202b2"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmeta_1_1classify_1_1sgd.html#ab4f2046211231e4fee7d5f1d651202b2">coeff_</a> {1.0}</td></tr>
<tr class="memdesc:ab4f2046211231e4fee7d5f1d651202b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">The scalar coefficient for the weights vector. <br/></td></tr>
<tr class="separator:ab4f2046211231e4fee7d5f1d651202b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d95b758bae09438669884aed57d3d35"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5d95b758bae09438669884aed57d3d35"></a>
const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmeta_1_1classify_1_1sgd.html#a5d95b758bae09438669884aed57d3d35">alpha_</a></td></tr>
<tr class="memdesc:a5d95b758bae09438669884aed57d3d35"><td class="mdescLeft">&#160;</td><td class="mdescRight">\(\alpha\), the learning rate. <br/></td></tr>
<tr class="separator:a5d95b758bae09438669884aed57d3d35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ebd24e7c2ac9961cbe66eeba4d133f3"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9ebd24e7c2ac9961cbe66eeba4d133f3"></a>
const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmeta_1_1classify_1_1sgd.html#a9ebd24e7c2ac9961cbe66eeba4d133f3">gamma_</a></td></tr>
<tr class="memdesc:a9ebd24e7c2ac9961cbe66eeba4d133f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">\(\gamma\), the error threshold. <br/></td></tr>
<tr class="separator:a9ebd24e7c2ac9961cbe66eeba4d133f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f5f1e8bb72f136af54186c136f6d6bb"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7f5f1e8bb72f136af54186c136f6d6bb"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmeta_1_1classify_1_1sgd.html#a7f5f1e8bb72f136af54186c136f6d6bb">bias_</a></td></tr>
<tr class="memdesc:a7f5f1e8bb72f136af54186c136f6d6bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">\(b\), the bias. <br/></td></tr>
<tr class="separator:a7f5f1e8bb72f136af54186c136f6d6bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa70f746b1f2ae3accb46b1a915d0437f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa70f746b1f2ae3accb46b1a915d0437f"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmeta_1_1classify_1_1sgd.html#aa70f746b1f2ae3accb46b1a915d0437f">bias_weight_</a></td></tr>
<tr class="memdesc:aa70f746b1f2ae3accb46b1a915d0437f"><td class="mdescLeft">&#160;</td><td class="mdescRight">The weight of the bias term for each document (defaults to 1) <br/></td></tr>
<tr class="separator:aa70f746b1f2ae3accb46b1a915d0437f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d9b825e0e1e56f16d5c447e5979f756"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4d9b825e0e1e56f16d5c447e5979f756"></a>
const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmeta_1_1classify_1_1sgd.html#a4d9b825e0e1e56f16d5c447e5979f756">lambda_</a></td></tr>
<tr class="memdesc:a4d9b825e0e1e56f16d5c447e5979f756"><td class="mdescLeft">&#160;</td><td class="mdescRight">\(\lambda\), the regularization constant <br/></td></tr>
<tr class="separator:a4d9b825e0e1e56f16d5c447e5979f756"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8cd53c3de6a508f04ac11f338fa91bc9"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8cd53c3de6a508f04ac11f338fa91bc9"></a>
const size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmeta_1_1classify_1_1sgd.html#a8cd53c3de6a508f04ac11f338fa91bc9">max_iter_</a></td></tr>
<tr class="memdesc:a8cd53c3de6a508f04ac11f338fa91bc9"><td class="mdescLeft">&#160;</td><td class="mdescRight">The maximum number of iterations for training. <br/></td></tr>
<tr class="separator:a8cd53c3de6a508f04ac11f338fa91bc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad27e5b9dd9128f2e82e24193d22b0697"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad27e5b9dd9128f2e82e24193d22b0697"></a>
LossFunction&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmeta_1_1classify_1_1sgd.html#ad27e5b9dd9128f2e82e24193d22b0697">loss_</a></td></tr>
<tr class="memdesc:ad27e5b9dd9128f2e82e24193d22b0697"><td class="mdescLeft">&#160;</td><td class="mdescRight">The loss function to be used for the update. <br/></td></tr>
<tr class="separator:ad27e5b9dd9128f2e82e24193d22b0697"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_attribs_classmeta_1_1classify_1_1classifier"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classmeta_1_1classify_1_1classifier')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classmeta_1_1classify_1_1classifier.html">meta::classify::classifier&lt; index::forward_index &gt;</a></td></tr>
<tr class="memitem:a271788e29bb5b3ba10af1695e1ffb617 inherit pro_attribs_classmeta_1_1classify_1_1classifier"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a271788e29bb5b3ba10af1695e1ffb617"></a>
<a class="el" href="classmeta_1_1index_1_1forward__index.html">index::forward_index</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmeta_1_1classify_1_1classifier.html#a271788e29bb5b3ba10af1695e1ffb617">_idx</a></td></tr>
<tr class="memdesc:a271788e29bb5b3ba10af1695e1ffb617 inherit pro_attribs_classmeta_1_1classify_1_1classifier"><td class="mdescLeft">&#160;</td><td class="mdescRight">the index that the classifer is run on <br/></td></tr>
<tr class="separator:a271788e29bb5b3ba10af1695e1ffb617 inherit pro_attribs_classmeta_1_1classify_1_1classifier"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;class LossFunction&gt;<br/>
class meta::classify::sgd&lt; LossFunction &gt;</h3>

<p>Implements stochastic gradient descent for learning binary linear classifiers. </p>
<p>These may be extended to multiclass classification using the <a class="el" href="classmeta_1_1classify_1_1one__vs__all.html">one_vs_all</a> or all_vs_all adapters. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a88d43593c612c65a81e8b72828ef8f7d"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class LossFunction &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classmeta_1_1classify_1_1sgd.html">meta::classify::sgd</a>&lt; LossFunction &gt;::<a class="el" href="classmeta_1_1classify_1_1sgd.html">sgd</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmeta_1_1index_1_1forward__index.html">index::forward_index</a> &amp;&#160;</td>
          <td class="paramname"><em>idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha</em> = <code>0.001</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>gamma</em> = <code>1e-6</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>bias</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lambda</em> = <code>0.0001</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>max_iter</em> = <code>50</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">idx</td><td>The index to run the classifier on </td></tr>
    <tr><td class="paramname">alpha</td><td>\(alpha\), the learning rate </td></tr>
    <tr><td class="paramname">gamma</td><td>\(gamma\), the error threshold </td></tr>
    <tr><td class="paramname">bias</td><td>\(b\), the bias </td></tr>
    <tr><td class="paramname">lambda</td><td>\(\lambda\), the regularization constant </td></tr>
    <tr><td class="paramname">max_iter</td><td>The maximum number of iterations for training. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a61d0e7bcadc6519aafc1f7a7ad374a76"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class LossFunction &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classmeta_1_1classify_1_1sgd.html">meta::classify::sgd</a>&lt; LossFunction &gt;::<a class="el" href="classmeta_1_1classify_1_1sgd.html">sgd</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmeta_1_1index_1_1forward__index.html">index::forward_index</a> &amp;&#160;</td>
          <td class="paramname"><em>idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class_label&#160;</td>
          <td class="paramname"><em>positive_label</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha</em> = <code>0.001</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>gamma</em> = <code>1e-6</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>bias</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lambda</em> = <code>0.0001</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>max_iter</em> = <code>50</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">idx</td><td>The index to run the classifier on </td></tr>
    <tr><td class="paramname">positive_label</td><td>The label for the positive class (all others are assumed to be negative) </td></tr>
    <tr><td class="paramname">alpha</td><td>\(alpha\), the learning rate </td></tr>
    <tr><td class="paramname">gamma</td><td>\(gamma\), the error threshold </td></tr>
    <tr><td class="paramname">bias</td><td>\(b\), the bias </td></tr>
    <tr><td class="paramname">lambda</td><td>\(\lambda\), the regularization constant </td></tr>
    <tr><td class="paramname">max_iter</td><td>The maximum number of iterations for training. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a72fe830f32d506eff232b7be6a9333b9"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class LossFunction &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classmeta_1_1classify_1_1sgd.html">meta::classify::sgd</a>&lt; LossFunction &gt;::train </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; doc_id &gt; &amp;&#160;</td>
          <td class="paramname"><em>docs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Trains the sgd on the given training documents. </p>
<p>Maintains a set of weight vectors \(w_1,\ldots,w_K\) where \(K\) is the number of classes and updates them for each training document seen in each iteration. This continues until the error threshold is met or the maximum number of iterations is completed. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">docs</td><td>The training set. </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classmeta_1_1classify_1_1classifier.html#a27f1e34b37076dbbfca1b3c0af0b8d3d">meta::classify::classifier&lt; index::forward_index &gt;</a>.</p>

</div>
</div>
<a class="anchor" id="a3c80be17fa19e641f3eb788bf59881c4"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class LossFunction &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">class_label <a class="el" href="classmeta_1_1classify_1_1sgd.html">meta::classify::sgd</a>&lt; LossFunction &gt;::classify </td>
          <td>(</td>
          <td class="paramtype">doc_id&#160;</td>
          <td class="paramname"><em>d_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Classifies the given document. </p>
<p>The class label returned is \(\argmax_k(w_k^\intercal x_n + b)\)&mdash;in other words, the class whose associated weight vector gives the highest result.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">doc</td><td>The document to be classified. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The class label determined for the document. </dd></dl>

<p>Implements <a class="el" href="classmeta_1_1classify_1_1classifier.html#ade8be2ad9ce2996b38ab185dfb630cfd">meta::classify::classifier&lt; index::forward_index &gt;</a>.</p>

</div>
</div>
<a class="anchor" id="aa6851424c6d215ec60b1bc10db8c1157"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class LossFunction &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classmeta_1_1classify_1_1sgd.html">meta::classify::sgd</a>&lt; LossFunction &gt;::predict </td>
          <td>(</td>
          <td class="paramtype">doc_id&#160;</td>
          <td class="paramname"><em>d_id</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the dot product with the current weight vector. </p>
<p>Used mainly for generalization of a binary decision problem to a multiclass decision problem.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">doc</td><td>The document to compute the dot product with. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aa42f22d7c0df61f0b283b1f25b31d76a"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class LossFunction &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classmeta_1_1classify_1_1sgd.html">meta::classify::sgd</a>&lt; LossFunction &gt;::predict </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classmeta_1_1classify_1_1sgd.html#a42214fae688fdb92442abbec4d1d3e60">counts_t</a> &amp;&#160;</td>
          <td class="paramname"><em>doc</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper function that takes a sparse vector. </p>
<p>Used as a performance optimization during training.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">doc</td><td>the document to form a prediction for </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/sean/projects/meta/include/classify/classifier/<a class="el" href="sgd_8h_source.html">sgd.h</a></li>
<li>/home/sean/projects/meta/include/classify/classifier/sgd.tcc</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Feb 3 2014 19:55:39 for ModErn Text Analysis by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
